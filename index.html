<!DOCTYPE html>
<html lang="ja"><head><meta charset="UTF-8" /><link rel="apple-touch-icon" href="zeni_icon.jpg"><link rel="icon" href="zeni_icon.jpg"><link rel="stylesheet" href="zeni.css">
<title>銭げ婆ぁ！！</title></head><body><div class="container"><h2>お財布の魔術師になるザマス！！</h2><div class="controls"><label>おいくらザマスか！<input type="number" id="amount" placeholder="例: 3456" />
</label><label>欲しいお金はあるザマスか！<select id="coinSelect"><option value="none">枚数少ない順</option><option value="1">1円</option><option value="5">5円</option><option value="10">10円</option>
<option value="50">50円</option><option value="100">100円</option><option value="500">500円</option><option value="1000">1000円</option><option value="5000">5000円</option>
<option value="10000">10000円</option></select></label></div><div id="results">計算結果がここに表示されます</div></div><script>const amountInput = document.getElementById('amount');
const coinSelect  = document.getElementById('coinSelect');const resultsDiv  = document.getElementById('results');amountInput.addEventListener('input', updateResults);coinSelect .addEventListener('change', updateResults);
function generateDynamicPayments(amount){const ds   = String(amount).split('').map(Number);const len  = ds.length;const restDigits = ds.slice(1);if (restDigits.every(d => d === 0)) return [];
const base = 10 ** (len - 1);const cutUp = (ds[0] + 1) * base; const buckets = [];for(let i=1;i<len;i++){const d = ds[i];const place = 10 ** (len - 1 - i);if(d >= 5){buckets.push([ (d % 5) * place, d * place ]);
}else{buckets.push([ d * place ]);}}const pays = new Set();(function dfs(idx, acc){if(idx === buckets.length){ pays.add(cutUp + acc); return; }for(const v of buckets[idx]) dfs(idx+1, acc+v);
})(0, 0);pays.add(cutUp); return [...pays].sort((a,b)=>a-b);}function generateSequentialPayment(amount){const s = String(amount);let n = amount;let had = false; for(let i = s.length-1, pos=0; i>=0; i--, pos++){
const d = Number(s[i]);const place = 10 ** pos;let v = d * place;let r;if(pos === 0){ if(v >= 5){ r = v - 5; had = true; }else{ r = v;had = false; }}else{if(had) v += place;              
const threshold = 5 * place;if(v >= threshold){ r = v - threshold; had = true; }else{ r = v;had = false; }} n -= r;}const change = Math.abs(n);const pay = amount + change;
return pay;}function breakdownChange(change){const bd = {};let rest = change;if(rest >= 10000){const n10k = Math.floor(rest / 10000);if(n10k > 0) bd[10000] = n10k;rest %= 10000;}
let digit = Math.floor(rest / 1000);if(digit > 0){const q = Math.floor(digit / 5);const r = digit % 5;if(q>0) bd[5000] = (bd[5000]||0) + q;if(r>0) bd[1000] = (bd[1000]||0) + r;rest %= 1000;
}digit = Math.floor(rest / 100);if(digit > 0){const q = Math.floor(digit / 5);const r = digit % 5;if(q>0) bd[500]  = (bd[500] ||0) + q;if(r>0) bd[100]  = (bd[100] ||0) + r;
rest %= 100;}digit = Math.floor(rest / 10);if(digit > 0){const q = Math.floor(digit / 5);const r = digit % 5;if(q>0) bd[50]   = (bd[50]  ||0) + q;if(r>0) bd[10]   = (bd[10]  ||0) + r;
rest %= 10;}digit = rest;if(digit > 0){const q = Math.floor(digit / 5);const r = digit % 5;if(q>0) bd[5]    = (bd[5]   ||0) + q;if(r>0) bd[1]    = (bd[1]   ||0) + r;}const total = Object.values(bd).reduce((a,b)=>a+b,0);
return { bd, total };}function updateResults(){const amount = parseInt(amountInput.value);resultsDiv.innerHTML = '';if(!Number.isFinite(amount) || amount <= 0) return;const paysA = generateDynamicPayments(amount);
const payB  = generateSequentialPayment(amount);const allPays = Array.from(new Set([...paysA, payB]));const rows = allPays.map(pay=>{const change = pay - amount;const { bd, total } = breakdownChange(change);
return { pay, change, bd, total };});const sel = coinSelect.value;if(sel === 'none'){rows.sort((a,b)=>a.total - b.total);}else{const k = Number(sel);rows.sort((a,b)=> (b.bd[k]||0) - (a.bd[k]||0) );}
resultsDiv.innerHTML = rows.map(r=>{const lines = Object.entries(r.bd).sort((a,b)=>Number(b[0]) - Number(a[0])) .map(([k,v])=>`<li>${Number(k)}円: ${v} 枚</li>`).join('');
return `<div class="result"><div><b>支払い金額:</b> ¥${r.pay}</div>
        <div><b>お釣り:</b> ¥${r.change}</div>
        <div><b>枚数:</b> ${r.total} 枚</div>
        <ul class="denoms">${lines}</ul>
      </div>`;
  }).join('');
}
  </script>
</body>
</html>
